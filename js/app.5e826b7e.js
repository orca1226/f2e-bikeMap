(function(t){function e(e){for(var n,r,s=e[0],c=e[1],l=e[2],u=0,f=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},o=[];function r(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"28b82ad0"}[t]+".js"}function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.e=function(t){var e=[],a=i[t];if(0!==a)if(a)e.push(a[2]);else{var n=new Promise((function(e,n){a=i[t]=[e,n]}));e.push(a[2]=n);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=r(t);var l=new Error;o=function(e){c.onerror=c.onload=null,clearTimeout(u);var a=i[t];if(0!==a){if(a){var n=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+o+")",l.name="ChunkLoadError",l.type=n,l.request=o,a[1](l)}i[t]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/f2e-bikeMap/",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var p=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0353":function(t,e,a){t.exports=a.p+"img/icon-bikeStation-red.6b51afc7.svg"},3269:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex flex-col h-[100vh]",staticStyle:{height:"100vh"},attrs:{id:"app"}},[a("div",{attrs:{id:"nav"}},[a("Navbar")],1),a("div",{staticClass:"pages w-[100vw] flex-grow relative"},[a("div",{staticClass:"w-full h-full",attrs:{id:"map"}}),a("TheList",{attrs:{results:t.mapResults},on:{search:t.searchPlace}})],1)])},o=[],r=a("b85c"),s=a("1da1"),c=a("5530"),l=(a("99af"),a("d81d"),a("d3b7"),a("159b"),a("4e82"),a("7db0"),a("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"navbar w-full bg-prime-400 flex items-center px-6 justify-between z-50"},[n("router-link",{staticClass:"navbar__logo h-[26px] w-36 flex-grow",attrs:{to:{name:"Home"}}},[n("img",{staticClass:"h-full object-contain",attrs:{src:a("ea65"),alt:"logo"}})]),n("a",{staticClass:"text-12 text-prime-200",attrs:{href:"https://2021.thef2e.com/users/6296427084285739387"}},[t._v("Designer —— HsiaoHan Hsu")])],1)}),u=[],p={},f=p,m=(a("b3ee"),a("2877")),g=Object(m["a"])(f,l,u,!1,null,null,null),d=g.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-list w-[425px] overflow-y-auto py-[28px] px-[32px] absolute top-[36px] left-[36px] bottom-[36px] rounded-8px flex flex-col z-10 bg-white"},[n("div",{staticClass:"h-[36px] flex items-center flex-shrink-0"},[n("div",{staticClass:"h-full py-[4px] pl-[16px] pr-[32px] bg-gray-200 rounded-8px relative flex items-center flex-grow"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"bg-transparent h-full w-full focus-visible:outline-none",attrs:{type:"text",placeholder:"搜尋站點或鄰近地點"},domProps:{value:t.searchText},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),e.preventDefault(),t.goSearch.apply(null,arguments))},input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),n("button",{staticClass:"absolute right-2",attrs:{type:"button"},on:{click:t.goSearch}},[n("img",{attrs:{src:a("66d7"),alt:"icon"}})])])]),n("div",{staticClass:"mt-[36px] flex-grow overflow-y-auto"},t._l(t.results,(function(e,a){return n("div",{key:a,staticClass:"border-b border-gray-300 py-[20px]"},[n("h5",{staticClass:"text-prime-500 font-bold mb-[12px]"},[t._v(t._s(e.StationName.Zh_tw.split("_")[1]))]),n("div",{staticClass:"flex"},[n("div",{staticClass:"infoBlock h-[72px] flex-grow mr-3 rounded-8px flex flex-col items-center bg-prime-100 p-3 text-prime-500",class:{limit:e.AvailableRentBikes<=5,disabled:0===e.AvailableRentBikes}},[t._m(0,!0),n("h4",{staticClass:"font-bold transform -translate-y-1"},[t._v(t._s(e.AvailableRentBikes))])]),n("div",{staticClass:"infoBlock h-[72px] flex-grow ml-3 rounded-8px flex flex-col items-center bg-prime-100 p-3 text-prime-500",class:{limit:e.AvailableReturnBikes<=5,disabled:0===e.AvailableReturnBikes}},[t._m(1,!0),n("h4",{staticClass:"font-bold transform -translate-y-1"},[t._v(t._s(e.AvailableReturnBikes))])])]),n("div",{staticClass:"flex justify-between items-center mt-3"},[n("span",{staticClass:"label rounded-6px py-1 px-2 text-15 border border-solid border-accent-300 text-accent-500",class:{limit:t.getStationStatus(e)<0}},[t._v(t._s(t.getStationStatus(e,"text")))]),n("span",{staticClass:"text-gray-500 text-15"},[n("i",{staticClass:"fas fa-map-marker-alt mr-1"}),t._v(t._s(e.distance_text)+" 走路 "+t._s(e.distance_time))])])])})),0)])},h=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"text-15 transform -translate-y-1"},[a("i",{staticClass:"fas fa-bicycle mr-1"}),t._v("可租借")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"text-15 transform -translate-y-1"},[a("i",{staticClass:"fas fa-parking mr-1"}),t._v("可停車")])}],v={name:"TheList",props:{results:{type:Array}},data:function(){return{searchText:""}},methods:{goSearch:function(){console.log(123),this.$emit("search",this.searchText)},getStationStatus:function(t,e){var a;if(a=t.AvailableReturnBikes>0&&t.AvailableRentBikes>0?1:t.AvailableReturnBikes>0&&0===t.AvailableRentBikes?-1:0===t.AvailableReturnBikes&&t.AvailableRentBikes>0?-2:0,"text"!==e)return a;switch(a){case 0:return"站點施工中";case-1:return"只可還車";case-2:return"只可借車";default:return"可借可還"}}}},b=v,C=(a("fded"),Object(m["a"])(b,y,h,!1,null,null,null)),x=C.exports,w=[{CityName:"台北市",City:"Taipei",area:"北部"},{CityName:"新北市",City:"NewTaipei",area:"北部"},{CityName:"基隆市",City:"Keelung",area:"北部"},{CityName:"桃園市",City:"Taoyuan",area:"北部"},{CityName:"新竹市",City:"Hsinchu",area:"北部"},{CityName:"新竹縣",City:"HsinchuCounty",area:"北部"},{CityName:"宜蘭縣",City:"YilanCounty",area:"北部"},{CityName:"苗栗縣",City:"MiaoliCounty",area:"中部"},{CityName:"臺中市",City:"Taichung",area:"中部"},{CityName:"彰化縣",City:"ChanghuaCounty",area:"中部"},{CityName:"雲林縣",City:"YunlinCounty",area:"中部"},{CityName:"南投縣",City:"NantouCounty",area:"中部"},{CityName:"嘉義縣",City:"ChiayiCounty",area:"南部"},{CityName:"嘉義市",City:"Chiayi",area:"南部"},{CityName:"臺南市",City:"Tainan",area:"南部"},{CityName:"高雄市",City:"Kaohsiung",area:"南部"},{CityName:"屏東縣",City:"PingtungCounty",area:"南部"},{CityName:"花蓮縣",City:"HualienCounty",area:"東部"},{CityName:"臺東縣",City:"TaitungCounty",area:"東部"},{CityName:"金門縣",City:"KinmenCounty",area:"離島"},{CityName:"澎湖縣",City:"PenghuCounty",area:"離島"},{CityName:"連江縣",City:"LienchiangCounty",area:"離島"}],k={name:"googleMap",components:{Navbar:d,TheList:x},data:function(){return{countyConfig:w,google:null,googleMap:null,googleGeocoder:null,mapOptions:{zoom:15,mapTypeId:"roadmap",mapId:"fac25d86163ff505",streetViewControl:!1,mapTypeControl:!1,center:{lat:25,lng:121}},userLocation:{lat:25,lng:121},markers:[],loading:!0,city:null,searchLocation:null,mapResults:[]}},computed:{},methods:{getUserPosition:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){t.loading=!1,t.userLocation={lat:e.coords.latitude,lng:e.coords.longitude},t.googleMap.setCenter(t.userLocation),t.googleMap.setZoom(15),t.setMarker()}))},initMap:function(){this.googleMap=new this.google.maps.Map(document.getElementById("map"),this.mapOptions)},geocode:function(t){return this.googleGeocoder.geocode(t).then((function(t){return t.results[0].address_components})).catch((function(t){console.log(t)}))},setMarker:function(t,e){var a=new this.google.maps.Marker(Object(c["a"])({position:t,map:this.googleMap,animation:this.google.maps.Animation.DROP},e));this.markers.push(a)},searchPlace:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=e,i={query:t,fields:["formatted_address","place_id","geometry","name"]},o=new e.google.maps.places.PlacesService(e.googleMap),o.findPlaceFromQuery(i,(function(t,e){if(e===n.google.maps.places.PlacesServiceStatus.OK){var a=t[0];n.searchLocation={lat:a.geometry.location.lat(),lng:a.geometry.location.lng()},n.setMarker(a.geometry.location),n.geocode({location:a.geometry.location}).then((function(t){n.city=n.getCity(t),n.mapStationStatus(n.searchLocation)})),n.googleMap.setCenter(a.geometry.location),n.googleMap.setZoom(16)}}));case 4:case"end":return a.stop()}}),a)})))()},mapStationStatus:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.axios.all([e.$api.getCityBikeAvailability({city:e.city}).then((function(t){e.stationStatus=t.data})),e.$api.getCityBikeStation({city:e.city,paramsObj:{$spatialFilter:"nearby(".concat(t.lat,", ").concat(t.lng,", 500)")}}).then((function(t){e.stations=t.data})).catch((function(t){console.log(t)}))]);case 2:n=e.stations.map((function(t){return t.StationUID})),i=[],e.stationStatus.forEach((function(t){var a=n.indexOf(t.StationUID);-1!==a&&i.push(Object(c["a"])(Object(c["a"])({},t),e.stations[a]))})),e.getDistance(i);case 6:case"end":return a.stop()}}),a)})))()},getDistance:function(t){var e=this,n=this,i=[];t.forEach((function(t){i.push(new e.google.maps.LatLng(t.StationPosition.PositionLat,t.StationPosition.PositionLon))}));var o=new this.google.maps.DistanceMatrixService;o.getDistanceMatrix({origins:[this.searchLocation],destinations:i,travelMode:"WALKING",unitSystem:this.google.maps.UnitSystem.METRIC,avoidHighways:!0,avoidTolls:!0},(function(e,i){for(var o=0,s=t.length;o<s;o++)t[o].distance=e.rows[0].elements[o].distance.value,t[o].distance_text=e.rows[0].elements[o].distance.text,t[o].distance_time=e.rows[0].elements[o].duration.text;n.mapResults=t.sort((function(t,e){return t.distance>e.distance?1:-1}));var c,l=Object(r["a"])(n.mapResults);try{for(l.s();!(c=l.n()).done;){var u=c.value,p={lat:u.StationPosition.PositionLat,lng:u.StationPosition.PositionLon},f=void 0,m=void 0;u.AvailableRentBikes>0?(f=u.AvailableRentBikes>5?"#738047":"#E75578",m=u.AvailableRentBikes>5?"green":"red"):(f="#9A9A9A",m="gray"),n.setMarker(p,{label:{text:"".concat(u.AvailableRentBikes),color:f,fontWeight:"700"},icon:{url:a("6b30")("./icon-bikeStation-".concat(m,".svg")),scaledSize:new n.google.maps.Size(50,50),labelOrigin:new n.google.maps.Point(25,19)}})}}catch(g){l.e(g)}finally{l.f()}}))},getCity:function(t){var e=t.find((function(t){return-1!==t.types.indexOf("administrative_area_level_1")})),a=this.countyConfig.find((function(t){return t.CityName===e.long_name}));return a.City}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.gmapsInit();case 3:t.google=e.sent,t.googleGeocoder=new t.google.maps.Geocoder,t.initMap(),t.searchPlace("台北市"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}},S=k,_=(a("5c0b"),Object(m["a"])(S,i,o,!1,null,null,null)),O=_.exports,A=(a("3ca3"),a("ddb0"),a("8c4f")),M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"})},N=[],P={name:"Home",components:{}},T=P,j=Object(m["a"])(T,M,N,!1,null,null,null),B=j.exports;n["a"].use(A["a"]);var R=[{path:"/",name:"Home",component:B},{path:"/about",name:"About",component:function(){return a.e("about").then(a.bind(null,"f820"))}}],L=new A["a"]({routes:R}),E=L,D=a("bc3a"),H=a.n(D),$=a("6c2d");function z(){var t="cf4fc1f88024448c87de2f6276a32a13",e="11iMc9UPovBLtwlrr5wroVKmDXc",a=(new Date).toGMTString(),n=new $["a"]("SHA-1","TEXT");n.setHMACKey(e,"TEXT"),n.update("x-date: "+a);var i=n.getHMAC("B64"),o='hmac username="'+t+'", algorithm="hmac-sha1", headers="x-date", signature="'+i+'"';return{Authorization:o,"X-Date":a}}var I,U,F=H.a.create({baseURL:"https://ptx.transportdata.tw/MOTC/v2",headers:z(),timeout:3e4,params:{$format:"JSON"}}),K=F,Q={getCityBikeStation:function(t){var e=t.city,a=t.paramsObj,n="/Bike/Station/".concat(e);return K.get(n,{params:a})},getCityBikeAvailability:function(t){var e=t.city,a=t.paramsObj,n="/Bike/Availability/".concat(e);return K.get(n,{params:a})}},G=Q,Z=a("755e"),X="AIzaSyBgnlQTPezT-ASNOzQZeMOexhEOF66FLUQ",q="gmapsCallback",J=!!window.google,V=new Promise((function(t,e){I=t,U=e}));function W(){if(J)return V;J=!0,window[q]=function(){return I(window.google)};var t=document.createElement("script");return t.async=!0,t.defer=!0,t.src="https://maps.googleapis.com/maps/api/js?key=".concat(X,"&callback=").concat(q,"&libraries=places"),t.onerror=U,document.querySelector("head").appendChild(t),V}n["a"].use(Z,{load:{key:"AIzaSyBgnlQTPezT-ASNOzQZeMOexhEOF66FLUQ",libraries:"places"}}),n["a"].config.productionTip=!1,n["a"].prototype.$api=G,n["a"].prototype.axios=H.a,n["a"].prototype.gmapsInit=W,new n["a"]({router:E,render:function(t){return t(O)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"66d7":function(t,e,a){t.exports=a.p+"img/icon-search.64ed36b6.svg"},"697b":function(t,e,a){},"6b30":function(t,e,a){var n={"./icon-bikeStation-gray.svg":"abd1","./icon-bikeStation-green.svg":"d290","./icon-bikeStation-red.svg":"0353"};function i(t){var e=o(t);return a(e)}function o(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=o,t.exports=i,i.id="6b30"},"9c0c":function(t,e,a){},abd1:function(t,e,a){t.exports=a.p+"img/icon-bikeStation-gray.47a25f94.svg"},b3ee:function(t,e,a){"use strict";a("3269")},d290:function(t,e,a){t.exports=a.p+"img/icon-bikeStation-green.ae1d611c.svg"},ea65:function(t,e,a){t.exports=a.p+"img/logo-light.f4edbdf1.svg"},fded:function(t,e,a){"use strict";a("697b")}});
//# sourceMappingURL=app.5e826b7e.js.map